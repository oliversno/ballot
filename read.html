<body>

<div class="container">
    <input id="tokenInput" type="text" value="token?">
    <button id="read" class="btn" type="button">Read</button>
    <div id="voteContainer">
        <!-- Voting here -->
    </div>
</div>


<!-- The core Firebase JS SDK is always required and must be listed first -->
<script src="https://www.gstatic.com/firebasejs/7.9.3/firebase-app.js"></script>

<!-- TODO: Add SDKs for Firebase products that you want to use
     https://firebase.google.com/docs/web/setup#available-libraries -->
<script src="https://www.gstatic.com/firebasejs/7.9.3/firebase-database.js"></script>
<!-- JQuery -->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script>
// Your web app's Firebase configuration
var firebaseConfig = {
apiKey: "AIzaSyByAyDFaMNDwKpfRhAQPk0B70ILYst-oS4",
authDomain: "ballot-d933a.firebaseapp.com",
databaseURL: "https://ballot-d933a.firebaseio.com",
projectId: "ballot-d933a",
storageBucket: "ballot-d933a.appspot.com",
messagingSenderId: "227086842486",
appId: "1:227086842486:web:849611a5373b9fc0ce7d57",
measurementId: "G-Y8X924EG6M"
};
// Initialize Firebase
firebase.initializeApp(firebaseConfig);

function firebaseRead(token){
    firebase.database().ref('ballots/' + token).once('value').then(function(snapshot) {
        var ballotType = (snapshot.val() && snapshot.val().ballotType);
        var candidates = (snapshot.val() && snapshot.val().candidates);
    });
    return ballotType, candidates
}

$(function () {
    $("#read").bind("click", function () {
        var token = document.getElementById('tokenInput').value
        firebase.database().ref('ballots/' + token).once('value').then(function(snapshot) {
            var ballotType = (snapshot.val() && snapshot.val().ballotType);
            var candidates = (snapshot.val() && snapshot.val().candidates);
            if(ballotType == "First Past the Post"){
                for(i in candidates){
                    var div = $("<div />");
                    div.html(getRadio(candidates[i]));
                    $("#voteContainer").append(div);
                }
            }
            else if(ballotType == "Ranked Choice"){
                for(i in candidates){
                    var div = $("<div />");
                    div.html(getRanking(candidates[i], candidates.length));
                    $("#voteContainer").append(div);
                }
            }
            else if(ballotType == "Approval Voting"){
                for(i in candidates){
                    var div = $("<div />");
                    div.html(getCheck(candidates[i]));
                    $("#voteContainer").append(div);
                }
            }
        });
    });
});

function getRadio(candidate) {
    return '<input name="candidates" id="' + candidate + '" type="radio"/>' + 
        '<label for="' + candidate + '">' + candidate + '</label><br>'
}

function getCheck(candidate) {
    return '<input name="candidates" id="' + candidate + '" type="checkbox"/>' + 
        '<label for="' + candidate + '">' + candidate + '</label><br>'
}

function getRanking(candidate, n) {
    var header = '<p>' + candidate + ': </p>'
    for(var i=0; i < n; i++){
        header += '<input name="rankButton" id="' + i + '" type="radio"/>' +
            '<label for="' + i + '">' + (i+1) + '<\label>'
    }
    return header
}

</script>
</body>